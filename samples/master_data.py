
# List of stock tickers
bse_largecap = ["ABB.BO","ADANIENSOL.BO","ADANIENT.BO","ADANIGREEN.BO","ADANIPORTS.BO","ADANIPOWER.BO","ATGL.NS","AWL.NS","AMBUJACEM.BO","APOLLOHOSP.BO","ASIANPAINT.BO","DMART.BO","AXISBANK.BO","BAJAJ-AUTO.BO","BAJFINANCE.BO","BAJAJFINSV.BO","BAJAJHLDNG.BO","BANDHANBNK.BO","BANKBARODA.BO","BERGEPAINT.BO","BEL.BO","BPCL.BO","BHARTIARTL.BO","BOSCHLTD.BO","BRITANNIA.BO","CHOLAFIN.BO","CIPLA.BO","COALINDIA.BO","DABUR.BO","DIVISLAB.BO","DLF.BO","DRREDDY.BO","EICHERMOT.BO","NYKAA.NS","GAIL.BO","GODREJCP.BO","GRASIM.BO","HAVELLS.BO","HCLTECH.BO","HDFCAMC.BO","HDFCBANK.BO","HDFCLIFE.BO","HEROMOTOCO.BO","HINDALCO.BO","HAL.BO","HINDUNILVR.BO","HINDZINC.BO","ICICIBANK.BO","ICICIGI.BO","ICICIPRULI.BO","IOC.BO","INDUSTOWER.BO","INDUSINDBK.BO","NAUKRI.BO","INFY.BO","INDIGO.BO","ITC.BO","JIOFIN.NS","JSWSTEEL.BO","KOTAKBANK.BO","LT.BO","LICI.NS","LTIM.BO","M&M.BO","MANKIND.NS","MARICO.BO","MARUTI.BO","NESTLEIND.BO","NTPC.BO","ONGC.BO","PAYTM.NS","PIDILITIND.BO","POWERGRID.BO","PNB.BO","RELIANCE.BO","SBICARD.BO","SBILIFE.BO","SHREECEM.BO","SIEMENS.BO","SRF.BO","SBIN.BO","SUNPHARMA.BO","TCS.BO","TATACONSUM.BO","TATAMOTORS.BO","TATAMTRDVR.BO","TATAPOWER.BO","TATASTEEL.BO","TECHM.BO","TITAN.BO","ULTRACEMCO.BO","UNITDSPR.BO","UPL.BO","VBL.BO","VEDL.BO","WIPRO.BO","ZOMATO.BO","ZYDUSLIFE.NS"]
bse_midcap = ["3MINDIA.BO","AARTIIND.BO","ABBOTINDIA.BO","ACC.BO","ABCAPITAL.BO","ABFRL.BO","AJANTPHARM.BO","ALKEM.BO","APLAPOLLO.BO","ASHOKLEY.BO","ASTRAL.BO","AUBANK.BO","AUROPHARMA.BO","BALKRISIND.BO","BANKINDIA.BO","BAYERCROP.BO","BHARATFORG.BO","BHEL.BO","BIOCON.BO","CANBK.BO","CASTROLIND.BO","CGPOWER.BO","CLEAN.BO","COLPAL.BO","CONCOR.BO","COROMANDEL.BO","CRISIL.BO","CROMPTON.BO","CUMMINSIND.BO","DALBHARAT.BO","DEEPAKNTR.BO","DELHIVERY.NS","EMAMILTD.BO","ENDURANCE.BO","EXIDEIND.BO","FEDERALBNK.BO","GICRE.BO","GILLETTE.BO","GLAND.BO","GLAXO.BO","GLENMARK.BO","GMRINFRA.BO","GODREJIND.BO","GODREJPROP.BO","FLUOROCHEM.BO","GUJGASLTD.BO","HINDPETRO.BO","HONAUT.BO","ISEC.BO","IDBI.BO","IDFCFIRSTB.BO","INDIANB.BO","INDHOTEL.BO","IOB.BO","IRCTC.BO","IRFC.BO","IREDA.BO","IGL.BO","IPCALAB.BO","JINDALSTEL.BO","JSWENERGY.BO","JSWINFRA.NS","JUBLFOOD.BO","KANSAINER.BO","LTF.BO","LTTS.BO","LAURUSLABS.BO","LICHSGFIN.BO","LINDEINDIA.BO","LUPIN.BO","LODHA.BO","M&MFIN.BO","MFSL.BO","MAXHEALTH.BO","MPHASIS.BO","MRF.BO","MUTHOOTFIN.BO","NHPC.BO","NAM-INDIA.BO","NMDC.BO","NUVOCO.BO","OBEROIRLTY.BO","OIL.BO","OFSS.BO","PAGEIND.BO","PATANJALI.NS","PAYTM.BO","PERSISTENT.BO","PETRONET.BO","PIIND.BO","PEL.BO","POLYCAB.BO","PFC.BO","PGHH.BO","RAJESHEXPO.BO","RAMCOCEM.BO","RECLTD.BO","RELAXO.BO","MOTHERSON.BO","SCHAEFFLER.BO","SHRIRAMFIN.BO","SJVN.BO","SOLARINDS.BO","SONACOMS.BO","STARHEALTH.NS","SAIL.BO","SUNTV.BO","SUPREMEIND.BO","TATACOMM.BO","TATAELXSI.BO","TATATECH.BO","NIACL.BO","TORNTPHARM.BO","TORNTPOWER.BO","TRENT.BO","TIINDIA.BO","TVSMOTOR.BO","UCOBANK.BO","UNIONBANK.BO","UBL.BO","UNOMINDA.BO","VEDL.BO","IDEA.BO","VOLTAS.BO","WHIRLPOOL.BO","YESBANK.BO","ZEEL.BO"]
bse_smallcap = [
    '360ONE.NS', '3IINFOLTD.NS', '5PAISA.NS', '63MOONS.NS', 'AARTIDRUGS.NS', 'AARTIPHARM.NS', 'AAVAS.NS', 'AHL.NS',
    'ACCELYA.NS', 'ACE.NS', 'ADFFOODS.NS', 'ABSLAMC.NS', 'AVL.BO', 'ADORWELD.NS', 'ADVENZYMES.NS', 'AEGISCHEM.NS',
    'AEROFLEX.NS', 'AETHER.NS', 'AFFLE.NS', 'AGARIND.NS', 'AGI.NS', 'ATFL.NS', 'AGSTRA.NS', 'AHLUCONT.NS', 'AIAENG.NS',
    'AJMERA.NS', 'AKZOINDIA.NS', 'ALEMBICLTD.NS', 'APLLTD.NS', 'ALICON.NS', 'ALKYLAMINE.NS', 'ACLGATI.NS', 'ALLCARGO.NS',
    'ATL.NS', 'ALLSEC.NS', 'ALOKINDS.NS', 'ARE&M.NS', 'AMBER.NS', 'AMBIKCO.NS', 'AMIORG.NS', 'ANANDRATHI.NS', 'ANANTRAJ.NS',
    'ANDHRAPAP.NS', 'ANDHRAPET.BO', 'ANDREWYU.NS', 'ANGELONE.NS', 'AWHCL.NS', 'ANURAS.NS', 'APARINDS.NS', 'APCOTEXIND.NS',
    'APOLLO.NS', 'APOLLOPIPE.NS', 'APOLLOTYRE.NS', 'APTECHT.NS', 'APTUS.NS', 'ACI.NS', 'ARIHANTCAP.NS', 'ARIHANTSUP.NS',
    'ARMANFIN.NS', 'ARTEMISMED.NS', 'ARVINDFASN.NS', 'ARVIND.NS', 'ARVSMART.NS', 'ASAHIINDIA.NS', 'ASHAPURMIN.NS',
    'ASHIANA.NS', 'ASHOKA.NS', 'ASIANTILES.NS', 'ASKAUTOLTD.NS', 'ASALCBR.NS', 'ASTEC.NS', 'ASTERDM.NS', 'ASTRAMICRO.NS',
    'ASTRAZEN.NS', 'ATULAUTO.NS', 'ATUL.NS', 'AURIONPRO.NS', 'AIIL.BO', 'AUTOAXLES.NS', 'ASAL.NS', 'AVADHSUGAR.NS', 'AVALON.NS',
    'AVANTEL.NS', 'AVANTIFEED.NS', 'AVTNPL.NS', 'AXISCADES.NS', 'AZAD.NS', 'BLKASHYAP.NS', 'BAJAJCON.NS', 'BAJAJELEC.NS',
    'BAJAJHCARE.NS', 'BAJAJHIND.NS', 'BALAMINES.NS', 'BALMLAWRIE.NS', 'BLIL.BO', 'BALRAMCHIN.NS', 'BALUFORGE.BO',
    'BANCOINDIA.NS', 'MAHABANK.NS', 'BANARISUG.NS', 'BARBEQUE.NS', 'BASF.NS', 'BATAINDIA.NS', 'BCLIND.NS', 'BLAL.NS', 'BEML.NS',
    'BESTAGRO.NS', 'BFINVEST.NS', 'BFUTILITIE.NS', 'BHAGERIA.NS', 'BHAGCHEM.NS', 'BEPL.NS', 'BBL.NS', 'BDL.NS', 'BHARATWIRE.NS',
    'BIGBLOC.NS', 'BIKAJI.NS', 'BIRLACORPN.NS', 'BSOFT.NS', 'BBOX.NS', 'BLACKROSE.BO', 'BLISSGVS.NS', 'BLS.NS', 'BLUEDART.NS',
    'BLUEJET.NS', 'BLUESTARCO.NS', 'BODALCHEM.NS', 'BOMDYEING.NS', 'BOROLTD.NS', 'BORORENEW.NS', 'BRIGADE.NS', 'BUTTERFLY.NS',
    'MAPMYINDIA.NS', 'CAMLINFINE.NS', 'CAMPUS.NS', 'CANFINHOME.NS', 'CANTABIL.NS', 'CAPACITE.NS', 'CAPLIPOINT.NS', 'CGCL.NS',
    'CARBORUNIV.NS', 'CARERATING.NS', 'CARTRADE.NS', 'CARYSIL.NS', 'CCL.NS', 'CEATLTD.NS', 'CELLO.NS', 'CENTRALBK.NS',
    'CENTRUM.NS', 'CENTUM.NS', 'CENTENKA.NS', 'CENTURYPLY.NS', 'CENTURYTEX.NS', 'CERA.NS', 'CESC.NS', 'CHALET.NS', 'CLSEL.NS',
    'CHAMBLFERT.NS', 'CHEMCON.NS', 'CHEMPLASTS.NS', 'CHENNPETRO.NS', 'CHEVIOT.NS', 'CHOICEIN.NS', 'CHOLAHLDNG.NS', 'CIEINDIA.NS',
    'CIGNITITEC.NS', 'CUB.NS', 'CMSINFO.NS', 'COCHINSHIP.NS', 'COFFEEDAY.NS', 'COFORGE.NS', 'CAMS.NS', 'CONCORDBIO.NS',
    'CONFIPET.NS', 'CONTROLPR.NS', 'COSMOFIRST.NS', 'CRAFTSMAN.NS', 'CREDITACC.NS', 'MUFTI.BO', 'CRESSAN.BO', 'CSBBANK.NS',
    'CYIENTDLM.NS', 'CYIENT.NS', 'DLINKINDIA.NS', 'DALMIASUG.NS', 'DATAPATTNS.NS', 'DATAMATICS.NS', 'DBCORP.NS', 'DCBBANK.NS',
    'DCMSHRIRAM.NS', 'DCW.NS', 'DCXINDIA.NS', 'DDEVPLASTIK.BO', 'DECCANCE.NS', 'DEEPINDS.NS', 'DEEPAKFERT.NS', 'DELTACORP.NS',
    'DEN.NS', 'DEVYANI.NS', 'DBOL.NS', 'DHAMPURSUG.NS', 'DHANI.NS', 'DHANUKA.NS', 'DMCC.NS', 'DHARMAJ.NS', 'DHUNINV.NS', 'DBL.NS',
    'DISHTV.NS', 'DCAL.NS', 'DIVGIITTS.NS', 'DIXON.NS', 'DODLA.NS', 'DOLATALGO.NS', 'DOLLAR.NS', 'DOMS.NS', 'LALPATHLAB.NS',
    'DREAMFOLKS.NS', 'DREDGECORP.NS', 'DWARKESH.NS', 'DYNAMATECH.NS', 'EASEMYTRIP.NS', 'ECLERX.NS', 'EDELWEISS.NS', 'EIDPARRY.NS',
    'EIHAHOTELS.NS', 'EIHOTEL.NS', 'EKIEGS.NS', 'ELECON.NS', 'EMIL.NS', 'ELECTCAST.NS', 'ELGIEQUIP.NS', 'ELIN.NS',
    'ELPROINTL.BO', 'EMAMIPAP.NS', 'EMSLIMITED.NS', 'EMUDHRA.NS', 'ENGINERSIN.NS', 'ENIL.NS', 'EPIGRAL.NS', 'EPL.NS',
    'EQUITASBNK.NS', 'ERIS.NS', 'ESABINDIA.NS', 'ESAFSFB.NS', 'ESCORTS.NS', 'ESTER.NS', 'ETHOSLTD.NS', 'EUREKAFORBE.BO',
    'EVEREADY.NS', 'EVERESTIND.NS', 'EKC.NS', 'EXCELINDUS.NS', 'EXPLEOSOL.NS', 'FAIRCHEMOR.NS', 'FAZE3Q.BO', 'FDC.NS',
    'FEDFINA.NS', 'FMGOETZE.NS', 'FIEMIND.NS', 'FILATEX.NS', 'FINEORG.NS', 'FCL.NS', 'FINOPB.NS', 'FINCABLES.NS', 'FINPIPE.NS',
    'FSL.NS', 'FIVESTAR.NS', 'FLAIR.NS', 'FOODSIN.NS', 'FORCEMOT.NS', 'FORTIS.NS', 'FOSECOIND.NS', 'FUSION.NS', 'GMBREW.NS',
    'GNA.NS', 'GRINFRA.NS', 'GABRIEL.NS', 'GALAXYSURF.NS', 'GALLANTT.NS', 'GANDHAR.NS', 'GANDHITUBE.NS', 'GANESHBE.NS',
    'GANESHHOUC.NS', 'GANECOS.NS', 'GRSE.NS', 'GRWRHITECH.NS', 'GARFIBRES.NS', 'GATEWAY.NS', 'GEPIL.NS', 'GET&D.NS',
    'GENESYS.NS', 'GENSOL.NS', 'GENUSPOWER.NS', 'GEOJITFSL.NS', 'GFLLIMITED.NS', 'GHCL.NS', 'GHCLTEXTIL.NS', 'GICHSGFIN.NS',
    'GLENMARK.NS', 'MEDANTA.NS', 'GSLSU.NS', 'GLOBUSSPR.NS', 'GMMPFAUDLR.NS', 'GMRINFRA.NS', 'GOCOLORS.NS', 'GOCLCORP.NS',
    'GPIL.NS', 'GODFRYPHLP.NS', 'GODREJAGRO.NS', 'GOKEX.NS', 'GOKUL.NS', 'GOLDIAM.NS', 'GOODLUCK.NS', 'GOODYEAR.NS',
    'GRANULES.NS', 'GRAPHITE.NS', 'GRAUWEIL.NS', 'GRAVITA.NS', 'GESHIP.NS', 'GREAVESCOT.NS', 'GREENLAM.NS', 'GREENPANEL.NS',
    'GREENPLY.NS', 'GRINDWELL.NS', 'GRMOVER.NS', 'GTLINFRA.NS', 'GTPL.NS', 'GUFICBIO.NS', 'GUJALKALI.NS', 'GAEL.NS', 'GIPCL.NS',
    'GMDCLTD.NS', 'GNFC.NS', 'GPPL.NS', 'GSFC.NS', 'GSPL.NS', 'GUJTHEM.BO', 'GULFOILLUB.NS', 'GULPOLY.NS', 'HGINFRA.NS',
    'HAPPSTMNDS.NS', 'HAPPYFORGE.NS', 'HARDWYN.NS', 'HARIOMPIPE.NS', 'HARSHA.NS', 'HATHWAY.NS', 'HATSUN.NS', 'HAWKINCOOK.BO',
    'HBLPOWER.NS', 'HCG.NS', 'HEG.NS', 'HEIDELBERG.NS', 'HEMIPROP.NS', 'HERANBA.NS', 'HERCULES.NS', 'HERITGFOOD.NS',
    'HESTERBIO.NS', 'HEUBACHIND.NS', 'HFCL.NS', 'HITECH.NS', 'HIKAL.NS', 'HIL.NS', 'HSCL.NS', 'HIMATSEIDE.NS', 'HGS.NS',
    'HCC.NS', 'HINDCOPPER.NS', 'HNDFDS.NS', 'HINDOILEXP.NS', 'HINDWAREAP.NS', 'POWERINDIA.NS', 'HLEGLAS.NS', 'HLVLTD.NS',
    'HMAAGRO.NS', 'HOMEFIRST.NS', 'HONASA.NS', 'HONDAPOWER.NS', 'HUDCO.NS', 'HPAL.NS', 'HPL.NS', 'HUHTAMAKI.NS', 'ICRA.NS',
    'IDEA.NS', 'IDFC.NS', 'IFBIND.NS', 'IFCI.NS', 'IFGLEXPOR.NS', 'IGPL.NS', 'IGARASHI.NS', 'IIFL.NS', 'IIFLSEC.NS', 'IKIO.NS',
    'IMAGICAA.NS', 'INDIACEM.NS', 'INDIAGLYCO.NS', 'INDNIPPON.NS', 'IPL.NS', 'INDIASHLTR.NS', 'ITDC.NS', 'IBULHSGFIN.NS',
    'IBREALEST.NS', 'INDIAMART.NS', 'IEX.NS', 'INDIANHUME.NS', 'IMFA.NS', 'INDIGOPNTS.NS', 'INDOAMIN.NS', 'ICIL.NS',
    'INDORAMA.NS', 'INDOCO.NS', 'INDRAMEDCO.NS', 'INFIBEAM.NS', 'INFOBEAN.NS', 'INGERRAND.NS', 'INNOVACAP.NS', 'INOXGREEN.NS',
    'INOXINDIA.NS', 'INOXWIND.NS', 'INSECTICID.NS', 'INTELLECT.NS', 'IOLCP.NS', 'IONEXCHANG.NS', 'IRB.NS', 'IRCON.NS',
    'IRMENERGY.NS', 'ISGEC.NS', 'ITDCEM.NS', 'ITI.NS', 'JKIL.NS', 'JKTYRE.NS', 'JBCHEPHARM.NS', 'JKCEMENT.NS', 'JAGRAN.NS',
    'JAGSNPHARM.NS', 'JAIBALAJI.NS', 'JAICORPLTD.NS', 'JISLJALEQS.NS', 'JPASSOCIAT.NS', 'JPPOWER.NS', 'J&KBANK.NS', 'JAMNAAUTO.NS',
    'JAYBARMARU.NS', 'JAYAGROGN.NS', 'JAYNECOIND.NS', 'JBMA.NS', 'JINDRILL.NS', 'JINDALPOLY.NS', 'JINDALSAW.NS', 'JSL.NS',
    'JINDWORLD.NS', 'JKLAKSHMI.NS', 'JKPAPER.NS', 'JMFINANCIL.NS', 'JCHAC.NS', 'JSWHL.NS', 'JTEKTINDIA.NS', 'JTLIND.NS',
    'JUBLINDS.NS', 'JUBLINGREA.NS', 'JUBLPHARMA.NS', 'JLHL.NS', 'JWL.NS', 'JUSTDIAL.NS', 'JYOTHYLAB.NS', 'JYOTIRES.BO',
    'KABRAEXTRU.NS', 'KAJARIACER.NS', 'KPIL.NS', 'KALYANKJIL.NS', 'KALYANIFRG.NS', 'KSL.NS', 'KAMAHOLD.BO', 'KAMDHENU.NS',
    'KAMOPAINTS.NS', 'KANORICHEM.NS', 'KTKBANK.NS', 'KSCL.NS', 'KAYNES.NS', 'KDDL.NS', 'KEC.NS', 'KEI.NS', 'KELLTONTEC.NS',
    'KENNAMET.NS', 'KESORAMIND.NS', 'KKCL.NS', 'RUSTOMJEE.NS', 'KFINTECH.NS', 'KHAICHEM.NS', 'KINGFA.NS', 'KIOCL.NS',
    'KIRIINDUS.NS', 'KIRLOSBROS.NS', 'KIRLFER.NS', 'KIRLOSIND.NS', 'KIRLOSENG.NS', 'KIRLPNU.NS', 'KITEX.NS', 'KMCSHIL.BO',
    'KNRCON.NS', 'KOKUYOCMLN.NS', 'KOLTEPATIL.NS', 'KOPRAN.NS', 'KOVAI.NS', 'KPIGREEN.NS', 'KPITTECH.NS', 'KPRMILL.NS',
    'KRBL.NS', 'KIMS.NS', 'KRSNAA.NS', 'KSB.NS', 'KSOLVES.NS', 'KUANTUM.NS', 'LAOPALA.NS', 'LAXMIMACH.NS', 'LANCER.NS',
    'LANDMARK.NS', 'LATENTVIEW.NS', 'LXCHEM.NS', 'LEMONTREE.NS', 'LGBBROSLTD.NS', 'LIKHITHA.NS', 'LINC.NS', 'LINCOLN.NS',
    'LLOYDSENGG.NS', 'LLOYDSENT.BO', 'LLOYDSME.NS', 'LTFOODS.NS', 'LUMAXTECH.NS', 'LUMAXIND.NS', 'MMFL.NS', 'MKPL.NS',
    'MCLOUD.BO', 'MGL.NS', 'MTNL.NS', 'MAHSCOOTER.NS', 'MAHSEAMLES.NS', 'MHRIL.NS', 'MAHLIFE.NS', 'MAHLOG.NS', 'MANINDS.NS',
    'MANINFRA.NS', 'MANGCHEFER.NS', 'MANAKSIA.NS', 'MANALIPETC.NS', 'MANAPPURAM.NS', 'MANGLMCEM.NS', 'MRPL.NS', 'MVGJL.NS',
    'MANORAMA.NS', 'MARATHON.NS', 'MARKSANS.NS', 'MASFIN.NS', 'MASTEK.NS', 'MATRIMONY.NS', 'MAXESTATES.NS', 'MAYURUNIQ.NS',
    'MAZDOCK.NS', 'MEDICAMEQ.NS', 'MEDPLUS.NS', 'MOL.NS', 'MENONBE.NS', 'METROBRAND.NS', 'METROPOLIS.NS', 'MINDACORP.NS',
    'MIRZAINT.NS', 'MIDHANI.NS', 'MISHTANN.BO', 'MMTC.NS', 'MOIL.NS', 'MOLDTKPAC.NS', 'MONARCH.NS', 'MONTECARLO.NS',
    'MOREPENLAB.NS', 'MOSCHIP.BO', 'MSUMI.NS', 'MOTILALOFS.NS', 'MPSLTD.NS', 'BECTORFOOD.NS', 'MSTCLTD.NS', 'MTARTECH.NS',
    'MUKANDLTD.NS', 'MCX.NS', 'MUTHOOTMF.NS', 'NACLIND.NS', 'NAGAFERT.NS', 'NAHARCAP.NS', 'NAHARSPING.NS', 'NSIL.NS', 'NH.NS',
    'NATCOPHARM.NS', 'NATIONALUM.NS', 'NFL.NS', 'NAVINFLUOR.NS', 'NAVKARCORP.NS', 'NAVNETEDUL.NS', 'NAZARA.NS', 'NBCC.NS',
    'NCC.NS', 'NCLIND.NS', 'NELCAST.NS', 'NELCO.NS', 'NEOGEN.NS', 'NESCO.NS', 'NETWEB.NS', 'NETWORK18.NS', 'NEULANDLAB.NS',
    'NDTV.NS', 'NEWGEN.NS', 'NGLFINE.NS', 'NIITMTS.NS', 'NIITLTD.NS', 'NIKHILAD.BO', 'NILKAMAL.NS', 'NITINSPIN.NS',
    'NITTAGELA.BO', 'NLCINDIA.NS', 'NSLNISP.NS', 'NOCIL.NS', 'NOVARTIND.NS', 'NRBBEARING.NS', 'NUCLEUS.NS', 'NUVAMA.NS',
    'OLECTRA.NS', 'OMAXE.NS', 'ONMOBILE.NS', 'ONWARDTEC.NS', 'OPTIEMUS.NS', 'ORIENTBELL.NS', 'ORIENTCEM.NS', 'ORIENTELEC.NS',
    'GREENPOWER.NS', 'ORIENTPPR.NS', 'OAL.NS', 'OCCL.NS', 'ORIENTHOT.NS', 'OSWALGREEN.NS', 'PAISALO.NS', 'PANACEABIO.NS',
    'PANAMAPET.NS', 'PARADEEP.NS', 'PARAGMILK.NS', 'PARACABLES.NS', 'PARAS.NS', 'PATELENG.NS', 'PAUSHAKLTD.BO', 'PCJEWELLER.NS',
    'PCBL.NS', 'PDSL.NS', 'PGIL.NS', 'PENIND.NS', 'PERMAGN.BO', 'PFIZER.NS', 'PGEL.NS', 'PHOENIXLTD.NS', 'PILANIINVS.NS',
    'PPLPHARMA.NS', 'PITTIENG.NS', 'PIXTRANS.NS', 'PNBGILTS.NS', 'PNBHOUSING.NS', 'PNCINFRA.NS', 'POKARNA.NS', 'POLYMED.NS',
    'POLYPLEX.NS', 'POONAWALLA.NS', 'POWERMECH.NS', 'PRAJIND.NS', 'PRAKASHSTL.NS', 'DIAMONDYD.NS', 'PRAVEG.BO', 'PRECAM.NS',
    'PRECWIRE.NS', 'PRESTIGE.NS', 'PRICOLLTD.NS', 'PFOCUS.NS', 'PRIMO.BO', 'PRINCEPIPE.NS', 'PRSMJOHNSN.NS', 'PRIVISCL.NS',
    'PGHL.NS', 'PROTEAN.BO', 'PRUDENT.NS', 'PSPPROJECT.NS', 'PFS.NS', 'PTC.NS', 'PTCIL.BO', 'PSB.NS', 'PUNJABCHEM.NS',
    'PURVA.NS', 'PVRINOX.NS', 'QUESS.NS', 'QUICKHEAL.NS', 'QUINT.BO', 'RRKABEL.NS', 'RSYSTEMS.NS', 'RACLGEAR.BO', 'RADIANTCMS.NS',
    'RADICO.NS', 'RPEL.BO', 'RVNL.NS', 'RAILTEL.NS', 'RAIN.NS', 'RAINBOW.NS', 'RAJRATAN.NS', 'RALLIS.NS', 'RAMRAT.BO',
    'RAMASTEEL.NS', 'RAMCOIND.NS', 'RAMCOSYS.NS', 'RKFORGE.NS', 'RAMKY.NS', 'RANEHOLDIN.NS', 'RML.NS', 'RCF.NS', 'RATEGAIN.NS',
    'RATNAMANI.NS', 'RTNINDIA.NS', 'RTNPOWER.NS', 'RAYMOND.NS', 'RBLBANK.NS', 'REDINGTON.NS', 'REDTAPE.NS', 'REFEX.NS',
    'RIIL.NS', 'RELINFRA.NS', 'RPOWER.NS', 'RELIGARE.NS', 'RGL.NS', 'REPCOHOME.NS', 'REPRO.NS', 'RESPONIND.NS', 'RBA.NS',
    'RHIM.NS', 'RICOAUTO.NS', 'RISHABH.NS', 'RITES.NS', 'ROLEXRINGS.NS', 'ROSSARI.NS', 'ROSSELLIND.NS', 'ROTO.NS', 'ROUTE.NS',
    'ROHLTD.NS', 'RPGLIFE.NS', 'RPSGVENT.NS', 'RSWM.NS', 'RUBYMILLS.NS', 'RUPA.NS', 'RUSHIL.NS', 'SCHAND.NS', 'SHK.NS',
    'SJS.NS', 'SPAL.NS', 'SADHNANIQ.NS', 'SAFARI.NS', 'SAGCEM.NS', 'KALAMANDIR.NS', 'SALASAR.NS', 'SAMHI.NS', 'SANDHAR.NS',
    'SANDUMA.NS', 'SANGAMIND.NS', 'SANGHIIND.NS', 'SANGHVIMOV.NS', 'SANINFRA.BO', 'SANOFI.NS', 'SANSERA.NS', 'SAPPHIRE.NS',
    'SARDAEN.NS', 'SAREGAMA.NS', 'SASKEN.NS', 'SASTASUNDR.NS', 'SATINDLTD.NS', 'SATIA.NS', 'SATIN.NS', 'SOTL.NS', 'SBFC.NS',
    'SCHNEIDER.NS', 'SEAMECLTD.NS', 'SENCO.NS', 'SEPC.NS', 'SEQUENT.NS', 'SESHAPAPER.NS', 'SGFIN.BO', 'SHAILY.NS',
    'SHAKTIPUMP.NS', 'SHALBY.NS', 'SHALPAINTS.NS', 'SHANKARA.NS', 'SHANTIGEAR.NS', 'SHARDACROP.NS', 'SHARDAMOTR.NS',
    'SHAREINDIA.NS', 'SFL.NS', 'SHILPAMED.NS', 'SCI.NS', 'SHIVACEM.BO', 'SBCL.NS', 'SHIVALIK.NS', 'SHOPERSTOP.NS',
    'SHREDIGCEM.NS', 'SHREEPUSHK.NS', 'RENUKA.NS', 'SHREYAS.NS', 'SHRIRAMPPS.NS', 'SHYAMMETL.NS', 'SIGACHI.NS', 'SIGNATURE.NS',
    'SIRCA.NS', 'SIS.NS', 'SIYSIL.NS', 'SKFINDIA.NS', 'SKIPPER.NS', 'SMCGLOBAL.NS', 'SMLISUZU.NS', 'SMSPHARMA.NS',
    'SNOWMAN.NS', 'SOBHA.NS', 'SOLARA.NS', 'SDBL.NS', 'SOMANYCERA.NS', 'SONATSOFTW.NS', 'SOUTHBANK.NS', 'SPANDANA.NS',
    'SPECIALITY.NS', 'SPENCERS.NS', 'SPICEJET.NS', 'SPORTKING.NS', 'SRHHYPOLTD.NS', 'SAINTGOBAIN.BO', 'STARCEMENT.NS',
    'STEELXIND.NS', 'SSWL.NS', 'STEELCAS.NS', 'SWSOLAR.NS', 'STERTOOLS.NS', 'STLTECH.NS', 'STOVEKRAFT.NS', 'STAR.NS',
    'STYLAMIND.NS', 'STYRENIX.NS', 'SUBEXLTD.NS', 'SUBROS.NS', 'SUDARSCHEM.NS', 'SUKHJITS.NS', 'SULA.NS', 'SUMICHEM.NS',
    'SUMMITSEC.NS', 'SPARC.NS', 'SUNCLAY.NS', 'SUNDRMFAST.NS', 'SUNFLAG.NS', 'SUNTECK.NS', 'SUPRAJIT.NS', 'SPLPETRO.NS',
    'SUPRIYA.NS', 'SURAJEST.NS', 'SURYAROSNI.NS', 'SURYODAY.NS', 'SUTLEJTEX.NS', 'SUVEN.NS', 'SUVENPHAR.NS', 'SUZLON.NS',
    'SWANENERGY.NS', 'SWARAJENG.NS', 'SYMPHONY.NS', 'SYNCOMF.NS', 'SYNGENE.NS', 'SYRMA.NS', 'TAJGVK.NS', 'TALBROAUTO.NS',
    'TMB.NS', 'TNPL.NS', 'TNPETRO.NS', 'TANFACIND.BO', 'TANLA.NS', 'TARC.NS', 'TARSONS.NS', 'TASTYBITE.NS', 'TATACHEM.NS',
    'TATAINVEST.NS', 'TTML.NS', 'TATVA.NS', 'TCIEXP.NS', 'TCNSBRANDS.NS', 'TCPLPACK.NS', 'TDPOWERSYS.NS', 'TEAMLEASE.NS',
    'TECHNOE.NS', 'TIIL.NS', 'TEGA.NS', 'TEJASNET.NS', 'TEXRAIL.NS', 'TGVSL.BO', 'THANGAMAYL.NS', 'ANUP.NS', 'THEMISMED.NS',
    'THERMAX.NS', 'TIRUMALCHM.NS', 'THOMASCOOK.NS', 'THYROCARE.NS', 'TI.NS', 'TIMETECHNO.NS', 'TIMEX.BO', 'TIMKEN.NS',
    'TIPSINDLTD.NS', 'TITAGARH.NS', 'TFCILTD.NS', 'TRACXN.NS', 'TRIL.NS', 'TREL.NS', 'TRANSPEK.BO', 'TCI.NS', 'TRIDENT.NS',
    'TRIVENI.NS', 'TRITURBINE.NS', 'TRU.NS', 'TTKHLTCARE.NS', 'TTKPRESTIG.NS', 'TVTODAY.NS', 'TV18BRDCST.NS', 'TVSELECT.NS',
    'TVSHLTD.NS', 'TVSSRICHAK.NS', 'TVSSCS.NS', 'UDAICEMENT.NS', 'UFLEX.NS', 'UGARSUGAR.NS', 'UGROCAP.NS', 'UJJIVANSFB.NS',
    'ULTRAMAR.BO', 'UNICHEMLAB.NS', 'UNIPARTS.NS', 'UNIVCABLES.NS', 'UDS.NS', 'USHAMART.NS', 'UTIAMC.NS', 'UTKARSHBNK.NS',
    'UTTAMSUGAR.NS', 'VGUARD.NS', 'VMART.NS', 'VSTTILLERS.NS', 'WABAG.NS', 'VADILALIND.NS', 'VAIBHAVGBL.NS', 'VAKRANGEE.NS',
    'VALIANTORG.NS', 'DBREALTY.NS', 'VSSL.NS', 'VTL.NS', 'VARROC.NS', 'VASCONEQ.NS', 'VENKEYS.NS', 'VENUSPIPES.NS',
    'VERANDA.NS', 'VESUVIUS.NS', 'VIDHIING.NS', 'VIJAYA.NS', 'VIKASLIFE.NS', 'VIMTALABS.NS', 'VINATIORGA.NS', 'VINDHYATEL.NS',
    'VINYLINDIA.NS', 'VIPIND.NS', 'VISAKAIND.NS', 'VISHNU.NS', 'VPRPL.NS', 'VLSFINANCE.NS', 'VOLTAMP.NS', 'VRLLOG.NS',
    'VSTIND.NS', 'WAAREERTL.BO', 'WARDINMOBI.BO', 'WELCORP.NS', 'WELENT.NS', 'WELSPUNLIV.NS', 'WELSPLSOL.NS', 'WENDT.NS',
    'WSTCSTPAPR.NS', 'WESTLIFE.NS', 'WOCKPHARMA.NS', 'WONDERLA.NS', 'WPIL.BO', 'XCHANGING.NS', 'YASHO.NS', 'YATHARTH.NS',
    'YATRA.NS', 'YUKEN.NS', 'ZAGGLE.NS', 'ZEEMEDIA.NS', 'ZENTEC.NS', 'ZENSARTECH.NS', 'ZFCVINDIA.NS', 'ZUARI.NS', 'ZYDUSWELL.NS'
]



import yfinance as yf
import pandas as pd
import streamlit as st
import plotly.express as px

# List of Yahoo tickers (replace this with actual tickers)
# Dropdown for selecting ticker category
ticker_category = st.sidebar.selectbox("Select Index", ["BSE-LargeCap", "BSE-MidCap", "BSE-SmallCap"])
# Set tickers based on selected category
if ticker_category == "BSE-LargeCap":
    tickers = bse_largecap
elif ticker_category == "BSE-MidCap":
    tickers = bse_midcap
else:
    tickers = bse_smallcap

# Caching the data retrieval function
@st.cache_data
def get_sector_industry_price_changes(tickers):
    data = {
        'Ticker': [], 'Company Name': [], 'Sector': [], 'Industry': [], 'Market Cap': [], 'Last Traded Price': [],
        '1D % Change': [], '2D % Change': [], '3D % Change': [], '5D % Change': [], '2W % Change': [],
        '1M % Change': [], '3M % Change': [], '6M % Change': [], '1Y % Change': [],
        '1D Volume': [], '2D Volume': [], '5D Volume': [], '2W Volume': [],
        '1M Volume': [], '3M Volume': [], '6M Volume': [], '1Y Volume': [],
        'Volume Change %': []
    }
    for ticker in tickers:
        try:
            stock = yf.Ticker(ticker)
            info = stock.info
            price_data_1y = yf.download(ticker, period='1y')
            
            if not price_data_1y.empty:
                last_traded_price = price_data_1y['Close'].iloc[-1]
                one_day_volume = price_data_1y['Volume'].iloc[-1]
                two_day_volume = price_data_1y['Volume'].iloc[-2:].mean()
                five_day_volume = price_data_1y['Volume'].iloc[-5:].mean()
                two_week_volume = price_data_1y['Volume'].iloc[-10:].mean()
                one_month_volume = price_data_1y['Volume'].iloc[-21:].mean()
                three_month_volume = price_data_1y['Volume'].iloc[-63:].mean()
                six_month_volume = price_data_1y['Volume'].iloc[-126:].mean()
                one_year_volume = price_data_1y['Volume'].mean()
                avg_volume = price_data_1y['Volume'].mean()
                volume_change = ((one_day_volume - avg_volume) / avg_volume) * 100 if avg_volume != 0 else 'N/A'
                price_changes = price_data_1y['Close'].pct_change() * 100
                one_day_change = price_changes.iloc[-1]
                two_day_change = price_changes.iloc[-2:].sum()
                three_day_change = price_changes.iloc[-3:].sum()
                five_day_change = price_changes.iloc[-5:].sum()
                two_week_change = price_changes.iloc[-10:].sum()
                one_month_change = price_changes.iloc[-21:].sum()
                three_month_change = price_changes.iloc[-63:].sum()
                six_month_change = price_changes.iloc[-126:].sum()
                one_year_change = price_changes.sum()
            else:
                last_traded_price = 'N/A'
                one_day_volume = 'N/A'
                two_day_volume = 'N/A'
                five_day_volume = 'N/A'
                two_week_volume = 'N/A'
                one_month_volume = 'N/A'
                three_month_volume = 'N/A'
                six_month_volume = 'N/A'
                one_year_volume = 'N/A'
                volume_change = 'N/A'
                one_day_change = 'N/A'
                two_day_change = 'N/A'
                three_day_change = 'N/A'
                five_day_change = 'N/A'
                two_week_change = 'N/A'
                one_month_change = 'N/A'
                three_month_change = 'N/A'
                six_month_change = 'N/A'
                one_year_change = 'N/A'
            
            data['Ticker'].append(ticker)
            data['Company Name'].append(info.get('longName', 'N/A'))
            data['Sector'].append(info.get('sector', 'N/A'))
            data['Industry'].append(info.get('industry', 'N/A'))
            data['Last Traded Price'].append(last_traded_price)
            data['Market Cap'].append(info.get('marketCap', 'N/A'))
            data['1D % Change'].append(one_day_change)
            data['2D % Change'].append(two_day_change)
            data['3D % Change'].append(three_day_change)
            data['5D % Change'].append(five_day_change)
            data['2W % Change'].append(two_week_change)
            data['1M % Change'].append(one_month_change)
            data['3M % Change'].append(three_month_change)
            data['6M % Change'].append(six_month_change)
            data['1Y % Change'].append(one_year_change)
            data['1D Volume'].append(one_day_volume)
            data['2D Volume'].append(two_day_volume)
            data['5D Volume'].append(five_day_volume)
            data['2W Volume'].append(two_week_volume)
            data['1M Volume'].append(one_month_volume)
            data['3M Volume'].append(three_month_volume)
            data['6M Volume'].append(six_month_volume)
            data['1Y Volume'].append(one_year_volume)
            data['Volume Change %'].append(volume_change)
        
        except Exception as e:
            st.error(f"Error fetching data for {ticker}: {e}")
    
    df = pd.DataFrame(data)
    
    # Convert all relevant columns to numeric and fill NaNs with 0
    numeric_columns = [col for col in df.columns if col not in ['Ticker', 'Company Name', 'Sector', 'Industry']]
    df[numeric_columns] = df[numeric_columns].apply(pd.to_numeric, errors='coerce').fillna(0)

    return df

# Get company name, sector, industry, price, last traded price, market capitalization, price changes, volume, average volume, and volume change % information
sector_industry_price_changes_df = get_sector_industry_price_changes(tickers)

# Streamlit app
st.title('Market Stats')
st.dataframe(sector_industry_price_changes_df)
st.subheader('Price')
# Dropdown menu to select the period for price change bar chart analysis
price_chart_option = st.selectbox('Select period to view price changes:', [
    '1D % Change', '2D % Change', '3D % Change', '5D % Change',
    '2W % Change', '1M % Change', '3M % Change', '6M % Change', '1Y % Change'
])

# Prepare data for the selected period from the existing dataframe
df_price_sorted = sector_industry_price_changes_df[['Ticker', price_chart_option]].copy()
df_price_sorted[price_chart_option] = pd.to_numeric(df_price_sorted[price_chart_option], errors='coerce')
df_price_sorted = df_price_sorted.sort_values(by=price_chart_option, ascending=False).reset_index(drop=True)
df_price_sorted.columns = ['Ticker', '% Change']

# Display the selected price change bar chart
fig_price = px.bar(df_price_sorted, x='Ticker', y='% Change', title=f'{price_chart_option} Gainers/Losers', color='% Change', color_continuous_scale=px.colors.diverging.RdYlGn)
st.plotly_chart(fig_price)
# Aggregating and plotting sector and industry performance
st.subheader('Volume')
# Dropdown menu to select the period for volume bar chart analysis
volume_chart_option = st.selectbox('Select period to view volume changes:', [
    '1D Volume', '2D Volume', '5D Volume', '2W Volume',
    '1M Volume', '3M Volume', '6M Volume', '1Y Volume'
])

# Prepare data for the selected volume period from the existing dataframe
df_volume_sorted = sector_industry_price_changes_df[['Ticker', volume_chart_option]].copy()
df_volume_sorted[volume_chart_option] = pd.to_numeric(df_volume_sorted[volume_chart_option], errors='coerce')
df_volume_sorted = df_volume_sorted.sort_values(by=volume_chart_option, ascending=False).reset_index(drop=True)
df_volume_sorted.columns = ['Ticker', 'Volume']

# Display the selected volume change bar chart
fig_volume = px.bar(df_volume_sorted, x='Ticker', y='Volume', title=f'{volume_chart_option} Volume', color='Volume', color_continuous_scale=px.colors.diverging.RdYlGn)
st.plotly_chart(fig_volume)

# Aggregating and plotting sector and industry performance
st.subheader('Sector and Industry Performance')

# Select only numeric columns for aggregation
numeric_columns = [col for col in sector_industry_price_changes_df.columns if col not in ['Ticker', 'Company Name', 'Sector', 'Industry']]

# Sector performance
sector_performance = sector_industry_price_changes_df.groupby('Sector')[numeric_columns].mean().reset_index()
sector_chart_option = st.selectbox('Select period to view sector performance:', numeric_columns)

sector_sorted = sector_performance[['Sector', sector_chart_option]].copy()
sector_sorted = sector_sorted.sort_values(by=sector_chart_option, ascending=False).reset_index(drop=True)
sector_sorted.columns = ['Sector', '% Change']

fig_sector = px.bar(sector_sorted, x='Sector', y='% Change', title=f'{sector_chart_option} by Sector', color='% Change', color_continuous_scale=px.colors.diverging.RdYlGn)
st.plotly_chart(fig_sector)

# Industry performance
industry_performance = sector_industry_price_changes_df.groupby('Industry')[numeric_columns].mean().reset_index()
industry_chart_option = st.selectbox('Select period to view industry performance:', numeric_columns)

industry_sorted = industry_performance[['Industry', industry_chart_option]].copy()
industry_sorted = industry_sorted.sort_values(by=industry_chart_option, ascending=False).reset_index(drop=True)
industry_sorted.columns = ['Industry', '% Change']

fig_industry = px.bar(industry_sorted, x='Industry', y='% Change', title=f'{industry_chart_option} by Industry', color='% Change', color_continuous_scale=px.colors.diverging.RdYlGn)
st.plotly_chart(fig_industry)

